
(function($){_subscribe_topics={};_subscribe_handlers={};$.fn.extend({createTopic:function(topic){if(!_subscribe_topics[topic]){_subscribe_topics[topic]={};_subscribe_topics[topic].objects={};_subscribe_topics[topic].objects['__noId__']=[];}
return this;},destroyTopic:function(topic){if(!_subscribe_topics[topic]){for(i in _subscribe_topics[topic].objects){var object=_subscribe_topics[topic].objects[i];if($.isArray(object)){for(j in object){object[j].unbind(topic);}}else{object.unbind(topic,data);}}}
return this;},subscribe:function(topic,handler,data){this.createTopic(topic);if(this.attr('id')){_subscribe_topics[topic].objects[this.attr('id')]=this;}else{_subscribe_topics[topic].objects['__noId__'].push(this);}
if(typeof(handler)=='function'){this.bind(topic,data,handler);}else if(typeof(handler)=='string'&&typeof(_subscribe_handlers[handler])=='function'){this.bind(topic,data,_subscribe_handlers[handler]);}
return this;},unsubscribe:function(topic){if(topic&&this.attr('id')){if(_subscribe_topics[topic]){var object=_subscribe_topics[topic].objects[this.attr('id')];if(object){this.unbind(topic,handler);delete _subscribe_topics[topic].objects[this.attr('id')];}}}
return this;},publish:function(topic,data){this.createTopic(topic);for(i in _subscribe_topics[topic].objects){var object=_subscribe_topics[topic].objects[i];if($.isArray(object)){if(object.length>0){for(j in object){object[j].trigger(topic,data);}}}else{object.trigger(topic,data);}}
return this;},publishOnEvent:function(event,topic,data){this.createTopic(topic);this.bind(event,data,function(e){$(this).publish(topic,e.data);});return this;}});$.extend({subscribeHandler:function(name,handler){if(name&&handler&&typeof(handler)=="function"){_subscribe_handlers[name]=handler;}
return $();},publish:function(topic,data){return $().publish(topic,data);},createTopic:function(topic){return $().createTopic(topic);},destroyTopic:function(topic){return $().destroyTopic(topic);}});})(jQuery);